import{_ as r,c as d,J as a,m as s,a as i,w as t,V as h,E as e,o}from"./chunks/framework.afRX3mrX.js";const T=JSON.parse('{"title":"Tokenize, Vectorize and Embedding","description":"","frontmatter":{"tags":["LLM","tokenize","vectorize","embedding"]},"headers":[],"relativePath":"Notes/Research/Road to LLM/Tokenize, Vectorize and Embedding.md","filePath":"Notes/Research/Road to LLM/Tokenize, Vectorize and Embedding.md"}'),g={name:"Notes/Research/Road to LLM/Tokenize, Vectorize and Embedding.md"},B=s("h1",{id:"tokenize-vectorize-and-embedding",tabindex:"-1"},[i("Tokenize, Vectorize and Embedding "),s("a",{class:"header-anchor",href:"#tokenize-vectorize-and-embedding","aria-label":'Permalink to "Tokenize, Vectorize and Embedding"'},"​")],-1),y=h('<h2 id="what-is-token" tabindex="-1">What is token <a class="header-anchor" href="#what-is-token" aria-label="Permalink to &quot;What is token&quot;">​</a></h2><p><img src="https://webresources.aaaab3n.moe/uPic/NvdeuG.png" alt="NvdeuG"> Token is more like translate human language to llm readable language use &quot;vocabulary&quot;. In compilers, &quot;<strong>Lexical tokenization</strong> is conversion of a text into (semantically or syntactically) meaningful <em>lexical tokens</em> belonging to categories defined by a &quot;lexer&quot; program&quot;, similar in LLM, LLM will <em>tokeninze</em> word into a &quot;number&quot; mostly depend on its &quot;word class&quot; or language properties.</p><h2 id="how-to-generate-token" tabindex="-1">How to generate token <a class="header-anchor" href="#how-to-generate-token" aria-label="Permalink to &quot;How to generate token&quot;">​</a></h2>',3),F=s("ol",null,[s("li",null,[i("Load model. (So the tokenizer is different from each model, in this case, "),s("code",null,"llama"),i(" use "),s("code",null,"SentencePiece"),i(" from Google (Not from llama itself))")]),s("li",null,[s("code",null,"SentencePiece"),i(": "),s("strong",null,"A versatile subword tokenizer and detokenizer for neural text processing"),i(". SentencePiece is a language-independent subword tokenizer and detokenizer designed for neural text processing, including neural machine translation (NMT)")])],-1),c=s("li",null,"Encode a string into a list of token IDs.",-1),A=s("h2",{id:"cost",tabindex:"-1"},[i("Cost "),s("a",{class:"header-anchor",href:"#cost","aria-label":'Permalink to "Cost"'},"​")],-1),D=s("p",null,[i("Try to run "),s("code",null,"tokenizer"),i(" for "),s("code",null,"meta-llama/llama")],-1),C=h(`<div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> llama </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> Tokenizer</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">model_path </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &#39;tokenizer.model&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">tokenizer </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#61AFEF;"> Tokenizer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">model_path</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">model_path)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">text </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;What is the answer to the life, the universe and everthing?&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">tokens </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> tokenizer.</span><span style="--shiki-light:#24292E;--shiki-dark:#61AFEF;">encode</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(text, </span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">bos</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">True</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">eos</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">False</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;">print</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(tokens)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">for</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> tid </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">in</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> tokens:</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">	tk </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> tokenizer.</span><span style="--shiki-light:#24292E;--shiki-dark:#61AFEF;">decode</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">([tid])</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">	</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;">	print</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">f</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">{</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">tid</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">:&gt;6</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> -&gt; &#39;</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">{</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">tk</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&#39;&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">	</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;">	print</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(tokenizer.</span><span style="--shiki-light:#24292E;--shiki-dark:#61AFEF;">decode</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(tokens))</span></span></code></pre></div><p>Result:</p><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">[</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">1724</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">338</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">278</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">1234</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">304</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">278</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">2834</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">29892</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">278</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">19859</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">322</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">3926</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">1918</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">29973</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">]</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">     1</span><span style="--shiki-light:#B31D28;--shiki-dark:#FFFFFF;--shiki-light-font-style:italic;--shiki-dark-font-style:inherit;"> -&gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &#39;&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">What </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">is</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> the answer to the life, the universe </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">and</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> everthing</span><span style="--shiki-light:#B31D28;--shiki-dark:#FFFFFF;--shiki-light-font-style:italic;--shiki-dark-font-style:inherit;">?</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">  1724</span><span style="--shiki-light:#B31D28;--shiki-dark:#FFFFFF;--shiki-light-font-style:italic;--shiki-dark-font-style:inherit;"> -&gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &#39;What&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">What </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">is</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> the answer to the life, the universe </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">and</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> everthing</span><span style="--shiki-light:#B31D28;--shiki-dark:#FFFFFF;--shiki-light-font-style:italic;--shiki-dark-font-style:inherit;">?</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">   338</span><span style="--shiki-light:#B31D28;--shiki-dark:#FFFFFF;--shiki-light-font-style:italic;--shiki-dark-font-style:inherit;"> -&gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &#39;is&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">What </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">is</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> the answer to the life, the universe </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">and</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> everthing</span><span style="--shiki-light:#B31D28;--shiki-dark:#FFFFFF;--shiki-light-font-style:italic;--shiki-dark-font-style:inherit;">?</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">   278</span><span style="--shiki-light:#B31D28;--shiki-dark:#FFFFFF;--shiki-light-font-style:italic;--shiki-dark-font-style:inherit;"> -&gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &#39;the&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">What </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">is</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> the answer to the life, the universe </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">and</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> everthing</span><span style="--shiki-light:#B31D28;--shiki-dark:#FFFFFF;--shiki-light-font-style:italic;--shiki-dark-font-style:inherit;">?</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">  1234</span><span style="--shiki-light:#B31D28;--shiki-dark:#FFFFFF;--shiki-light-font-style:italic;--shiki-dark-font-style:inherit;"> -&gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &#39;answer&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">What </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">is</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> the answer to the life, the universe </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">and</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> everthing</span><span style="--shiki-light:#B31D28;--shiki-dark:#FFFFFF;--shiki-light-font-style:italic;--shiki-dark-font-style:inherit;">?</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">   304</span><span style="--shiki-light:#B31D28;--shiki-dark:#FFFFFF;--shiki-light-font-style:italic;--shiki-dark-font-style:inherit;"> -&gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &#39;to&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">What </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">is</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> the answer to the life, the universe </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">and</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> everthing</span><span style="--shiki-light:#B31D28;--shiki-dark:#FFFFFF;--shiki-light-font-style:italic;--shiki-dark-font-style:inherit;">?</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">   278</span><span style="--shiki-light:#B31D28;--shiki-dark:#FFFFFF;--shiki-light-font-style:italic;--shiki-dark-font-style:inherit;"> -&gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &#39;the&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">What </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">is</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> the answer to the life, the universe </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">and</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> everthing</span><span style="--shiki-light:#B31D28;--shiki-dark:#FFFFFF;--shiki-light-font-style:italic;--shiki-dark-font-style:inherit;">?</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">  2834</span><span style="--shiki-light:#B31D28;--shiki-dark:#FFFFFF;--shiki-light-font-style:italic;--shiki-dark-font-style:inherit;"> -&gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &#39;life&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">What </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">is</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> the answer to the life, the universe </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">and</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> everthing</span><span style="--shiki-light:#B31D28;--shiki-dark:#FFFFFF;--shiki-light-font-style:italic;--shiki-dark-font-style:inherit;">?</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 29892</span><span style="--shiki-light:#B31D28;--shiki-dark:#FFFFFF;--shiki-light-font-style:italic;--shiki-dark-font-style:inherit;"> -&gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &#39;,&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">What </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">is</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> the answer to the life, the universe </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">and</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> everthing</span><span style="--shiki-light:#B31D28;--shiki-dark:#FFFFFF;--shiki-light-font-style:italic;--shiki-dark-font-style:inherit;">?</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">   278</span><span style="--shiki-light:#B31D28;--shiki-dark:#FFFFFF;--shiki-light-font-style:italic;--shiki-dark-font-style:inherit;"> -&gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &#39;the&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">What </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">is</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> the answer to the life, the universe </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">and</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> everthing</span><span style="--shiki-light:#B31D28;--shiki-dark:#FFFFFF;--shiki-light-font-style:italic;--shiki-dark-font-style:inherit;">?</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 19859</span><span style="--shiki-light:#B31D28;--shiki-dark:#FFFFFF;--shiki-light-font-style:italic;--shiki-dark-font-style:inherit;"> -&gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &#39;universe&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">What </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">is</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> the answer to the life, the universe </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">and</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> everthing</span><span style="--shiki-light:#B31D28;--shiki-dark:#FFFFFF;--shiki-light-font-style:italic;--shiki-dark-font-style:inherit;">?</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">   322</span><span style="--shiki-light:#B31D28;--shiki-dark:#FFFFFF;--shiki-light-font-style:italic;--shiki-dark-font-style:inherit;"> -&gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &#39;and&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">What </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">is</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> the answer to the life, the universe </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">and</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> everthing</span><span style="--shiki-light:#B31D28;--shiki-dark:#FFFFFF;--shiki-light-font-style:italic;--shiki-dark-font-style:inherit;">?</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">  3926</span><span style="--shiki-light:#B31D28;--shiki-dark:#FFFFFF;--shiki-light-font-style:italic;--shiki-dark-font-style:inherit;"> -&gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &#39;ever&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">What </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">is</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> the answer to the life, the universe </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">and</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> everthing</span><span style="--shiki-light:#B31D28;--shiki-dark:#FFFFFF;--shiki-light-font-style:italic;--shiki-dark-font-style:inherit;">?</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">  1918</span><span style="--shiki-light:#B31D28;--shiki-dark:#FFFFFF;--shiki-light-font-style:italic;--shiki-dark-font-style:inherit;"> -&gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &#39;thing&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">What </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">is</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> the answer to the life, the universe </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">and</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> everthing</span><span style="--shiki-light:#B31D28;--shiki-dark:#FFFFFF;--shiki-light-font-style:italic;--shiki-dark-font-style:inherit;">?</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 29973</span><span style="--shiki-light:#B31D28;--shiki-dark:#FFFFFF;--shiki-light-font-style:italic;--shiki-dark-font-style:inherit;"> -&gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &#39;?&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">What </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">is</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> the answer to the life, the universe </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">and</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> everthing</span><span style="--shiki-light:#B31D28;--shiki-dark:#FFFFFF;--shiki-light-font-style:italic;--shiki-dark-font-style:inherit;">?</span></span></code></pre></div><p>It runs on cpu, cost 200MB memory and 20% of 16 core CPU (paralleled).</p><h2 id="what-is-vectorize" tabindex="-1">What is Vectorize <a class="header-anchor" href="#what-is-vectorize" aria-label="Permalink to &quot;What is Vectorize&quot;">​</a></h2><p>A vector is a single-dimensional array of tokens.</p><h2 id="embedding" tabindex="-1">Embedding <a class="header-anchor" href="#embedding" aria-label="Permalink to &quot;Embedding&quot;">​</a></h2><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> sentence_transformers </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> SentenceTransformer</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">sentences </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> [</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;This is an example sentence&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Each sentence is converted&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">]</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  </span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">model </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#61AFEF;"> SentenceTransformer</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&#39;sentence-transformers/all-mpnet-base-v2&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">embeddings </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> model.</span><span style="--shiki-light:#24292E;--shiki-dark:#61AFEF;">encode</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(sentences)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;">print</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(embeddings)</span></span></code></pre></div><p>Output:</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>[[ 0.0225026  -0.07829173 -0.02303073 ... -0.00827929  0.02652686</span></span>
<span class="line"><span>  -0.00201898]</span></span>
<span class="line"><span> [ 0.04170233  0.00109741 -0.0155342  ... -0.02181629 -0.0635936</span></span>
<span class="line"><span>  -0.00875287]]</span></span></code></pre></div><p>Embedding is &quot;Encoded&quot; result of tokens and vectors processed by Transformer models. It not only contains the information of &quot;input words&quot;, but also information of &quot;sentences&quot;.</p><p>It cost 662 MB of GPU Memory.</p><h2 id="conclusion" tabindex="-1">Conclusion <a class="header-anchor" href="#conclusion" aria-label="Permalink to &quot;Conclusion&quot;">​</a></h2><ol><li>All embeddings are vectors, but not all vectors are embeddings.</li><li>Token is the basic unit.</li><li>LLMs take embeddings.</li></ol><p><img src="https://webresources.aaaab3n.moe/uPic/d8svlz.png" alt="d8svlz"></p><h2 id="references" tabindex="-1">References <a class="header-anchor" href="#references" aria-label="Permalink to &quot;References&quot;">​</a></h2>`,16),f=s("li",null,null,-1),u=s("h2",{id:"contributor",tabindex:"-1"},[i("Contributor "),s("a",{class:"header-anchor",href:"#contributor","aria-label":'Permalink to "Contributor"'},"​")],-1),E=s("h2",{id:"changelog",tabindex:"-1"},[i("Changelog "),s("a",{class:"header-anchor",href:"#changelog","aria-label":'Permalink to "Changelog"'},"​")],-1);function m(b,v,_,w,z,q){const l=e("NolebasePageProperties"),n=e("VPNolebaseInlineLinkPreview"),k=e("NolebaseGitContributors"),p=e("NolebaseGitChangelog");return o(),d("div",null,[B,a(l),y,s("ol",null,[s("li",null,[i("Read "),a(n,{href:"https://github.com/meta-llama/llama/blob/54c22c0d63a3f3c9e77f43a6a3041c00018f4964/llama/tokenizer.py#L14",target:"_blank",rel:"noreferrer"},{default:t(()=>[i("tokenizer.py")]),_:1}),F]),c]),A,D,s("p",null,[i("My code is (modified from "),a(n,{href:"https://gist.github.com/slaren/9f26fc4cb24685d42601b1d91d70a13a",target:"_blank",rel:"noreferrer"},{default:t(()=>[i("here")]),_:1}),i(")")]),C,s("ul",null,[s("li",null,[a(n,{href:"https://thenewstack.io/the-building-blocks-of-llms-vectors-tokens-and-embeddings/#:~:text=Embeddings%20are%20what%20allow%20LLMs,its%20relationships%20with%20other%20tokens",target:"_blank",rel:"noreferrer"},{default:t(()=>[i("https://thenewstack.io/the-building-blocks-of-llms-vectors-tokens-and-embeddings/#:~:text=Embeddings are what allow LLMs,its relationships with other tokens")]),_:1}),i(".")]),s("li",null,[a(n,{href:"https://medium.com/@liusimao8/using-llama-2-models-for-text-embedding-with-langchain-79183350593d",target:"_blank",rel:"noreferrer"},{default:t(()=>[i("https://medium.com/@liusimao8/using-llama-2-models-for-text-embedding-with-langchain-79183350593d")]),_:1})]),f]),u,a(k),E,a(p)])}const x=r(g,[["render",m]]);export{T as __pageData,x as default};
