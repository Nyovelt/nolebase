import{_ as h,c as o,J as i,m as s,a,w as d,V as k,E as e,o as r}from"./chunks/framework.WH0rnJL5.js";const q=JSON.parse('{"title":"通过 apt 升级和更新 1.28.4 版本的 kubeadm","description":"","frontmatter":{"tags":["计算机/操作系统/Linux","操作系统/Debian","操作系统/Debian/Debian-11","操作系统/Unix","运维/云原生/Kubernetes/K8s","运维/云原生/Kubernetes","命令行/kubectl","软件/云原生/kubectl","命令行/kubeadm","软件/云原生/kubeadm","软件/云原生/kubelet","命令行/apt","计算机/网络/Cilium","运维/Cilium","命令行/cilium","软件/云原生/Cilium"]},"headers":[],"relativePath":"笔记/🧱 基础设施/🚢 Kubernetes/Kubernetes 集群的日常升级和更新/通过 apt 升级和更新 1.28.4 版本的 kubeadm.md","filePath":"笔记/🧱 基础设施/🚢 Kubernetes/Kubernetes 集群的日常升级和更新/通过 apt 升级和更新 1.28.4 版本的 kubeadm.md"}'),c={name:"笔记/🧱 基础设施/🚢 Kubernetes/Kubernetes 集群的日常升级和更新/通过 apt 升级和更新 1.28.4 版本的 kubeadm.md"},u=s("h1",{id:"通过-apt-升级和更新-1-28-4-版本的-kubeadm",tabindex:"-1"},[a("通过 apt 升级和更新 1.28.4 版本的 "),s("code",null,"kubeadm"),a(),s("a",{class:"header-anchor",href:"#通过-apt-升级和更新-1-28-4-版本的-kubeadm","aria-label":'Permalink to "通过 apt 升级和更新 1.28.4 版本的 `kubeadm`"'},"​")],-1),g=k(`<h2 id="解除-debian-apt-依赖锚定-hold" tabindex="-1">解除 Debian <code>apt</code> 依赖锚定（hold） <a class="header-anchor" href="#解除-debian-apt-依赖锚定-hold" aria-label="Permalink to &quot;解除 Debian \`apt\` 依赖锚定（hold）&quot;">​</a></h2><p>可以先看看 <code>apt-mark</code> 里面是否记录了 <code>kubeadm</code> 的锚定（hold）：</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> apt-mark showhold </span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> more</span></span></code></pre></div><p>或者</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> dpkg --get-selections </span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> grep</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &#39;hold$&#39;</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> more</span></span></code></pre></div><p>如果返回值像是这样：</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light one-dark-pro has-highlighted vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> sudo apt-mark showhold </span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> more</span></span>
<span class="line highlighted"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">kubeadm</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">kubectl</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">kubelet</span></span></code></pre></div><p>可以先解除锚定。通过下面的命令就可以解除锚定，我们一个一个来：</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> apt-mark unhold kubeadm</span></span></code></pre></div><h2 id="明确目标版本并升级" tabindex="-1">明确目标版本并升级 <a class="header-anchor" href="#明确目标版本并升级" aria-label="Permalink to &quot;明确目标版本并升级&quot;">​</a></h2><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> apt search kubeadm</span></span></code></pre></div><p>就像这样</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light one-dark-pro has-highlighted vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> sudo apt search kubeadm</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">正在排序...</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 完成</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">全文搜索...</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 完成</span></span>
<span class="line highlighted"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">kubeadm/未知</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 1.28</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">.4-1.1 amd64 [可从该版本升级：1.28.2-1.1]</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  Command-line</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> utility for administering a Kubernetes cluster</span></span></code></pre></div><p>接下来定向升级：</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> apt update </span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">&amp;&amp; </span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> apt install -y kubeadm=&#39;1.28.4-*&#39;</span></span></code></pre></div><p>升级完成之后确保 <code>kubeadm version</code> 的输出符合预期</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> kubeadm version</span></span></code></pre></div><p>比如</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> sudo kubeadm version</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">kubeadm</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> version: </span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">&amp;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">version.Info</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">{Major:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">&quot;1&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">,</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> Minor:&quot;28&quot;, GitVersion:&quot;v1.28.4&quot;, GitCommit:&quot;bae2c62678db2b5053817bc97181fcc2e8388103&quot;, GitTreeState:&quot;clean&quot;, BuildDate:&quot;2023-11-15T16:56:18Z&quot;, GoVersion:&quot;go1.20.11&quot;, Compiler:&quot;gc&quot;, Platform:&quot;linux/amd64&quot;}</span></span></code></pre></div><h2 id="还原-debian-apt-依赖锚定-hold" tabindex="-1">还原 Debian <code>apt</code> 依赖锚定（hold） <a class="header-anchor" href="#还原-debian-apt-依赖锚定-hold" aria-label="Permalink to &quot;还原 Debian \`apt\` 依赖锚定（hold）&quot;">​</a></h2><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> apt-mark hold kubeadm</span></span></code></pre></div><p>锚定之后检查一下：</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> apt-mark showhold </span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> more</span></span></code></pre></div>`,23),F=s("h2",{id:"贡献者",tabindex:"-1"},[a("贡献者 "),s("a",{class:"header-anchor",href:"#贡献者","aria-label":'Permalink to "贡献者"'},"​")],-1),b=s("h2",{id:"文件历史",tabindex:"-1"},[a("文件历史 "),s("a",{class:"header-anchor",href:"#文件历史","aria-label":'Permalink to "文件历史"'},"​")],-1);function m(C,y,v,_,A,E){const t=e("NolebasePageProperties"),l=e("VPNolebaseInlineLinkPreview"),n=e("NolebaseGitContributors"),p=e("NolebaseGitChangelog");return r(),o("div",null,[u,i(t),g,s("p",null,[a("接下来返回 "),i(l,{href:"/笔记/🧱 基础设施/🚢 Kubernetes/Kubernetes 集群的日常升级和更新/1.28.2 升级和更新的操作步骤.html"},{default:d(()=>[a("1.28.2 升级和更新的操作步骤")]),_:1}),a("继续操作吧。")]),F,i(n),b,i(p)])}const f=h(c,[["render",m]]);export{q as __pageData,f as default};
