import{_ as d,c as r,J as a,m as s,a as i,w as l,V as t,E as n,o}from"./chunks/framework.WH0rnJL5.js";const c="/assets/resize-disk-partition-for-debian-12-screenshot-1.JmXlA5T9.png",P=JSON.parse('{"title":"为 Debian 使用的硬盘进行扩容操作","description":"","frontmatter":{"tags":["操作系统/Debian","操作系统/Debian/Debian-12","计算机科学/内存/虚拟内存/swap","操作系统/BIOS/引导/grub","计算机/操作系统/Linux/内核/initramfs","命令行/parted","操作系统/Busybox","命令行/update-grub","命令行/update-initramfs","命令行/e2fsck","命令行/resize2fs","操作系统/文件系统"]},"headers":[],"relativePath":"笔记/🎛️ 操作系统/🍥 Debian/为 Debian 使用的硬盘进行扩容操作.md","filePath":"笔记/🎛️ 操作系统/🍥 Debian/为 Debian 使用的硬盘进行扩容操作.md"}'),g={name:"笔记/🎛️ 操作系统/🍥 Debian/为 Debian 使用的硬盘进行扩容操作.md"},y=s("h1",{id:"为-debian-使用的硬盘进行扩容操作",tabindex:"-1"},[i("为 Debian 使用的硬盘进行扩容操作 "),s("a",{class:"header-anchor",href:"#为-debian-使用的硬盘进行扩容操作","aria-label":'Permalink to "为 Debian 使用的硬盘进行扩容操作"'},"​")],-1),F=t(`<div class="tip custom-block"><p class="custom-block-title">TIP</p><p>Debian 在安装的时候采取的默认的分区策略中会创建最后一个分区为 swap 分区，这样的 swap 分区是用来提供虚拟内存的，如果你希望在扩容的时候一同操作 swap 分区，甚至希望删除 swap 分区的话（比如正在运行 <code>kubelet</code> 的节点），可以通过下面的操作安全地关闭 swap 和移除 swap 分区的引用。</p><ol><li>先执行 <code>swapoff</code> 命令全局关闭 <code>swap</code>：</li></ol><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> swapoff -a</span></span></code></pre></div><ol start="2"><li>然后我们需要修改 <code>/etc/fstab</code> 中的 swap 分区的引用：</li></ol><p>使用</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> vim /etc/fstab</span></span></code></pre></div><p>来打开 Vim 编辑器编辑 <code>/etc/fstab</code>：</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light one-dark-pro has-diff has-highlighted vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;"># /etc/fstab: static file system information.</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">#</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;"># Use &#39;blkid&#39; to print the universally unique identifier for a</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;"># device; this may be used with UUID= as a more robust way to name devices</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;"># that works even if disks are added and removed. See fstab(5).</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">#</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;"># systemd generates mount units based on this file, see systemd.mount(5).</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;"># Please run &#39;systemctl daemon-reload&#39; after making changes here.</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">#</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;"># &lt;file system&gt; &lt;mount point&gt;   &lt;type&gt;  &lt;options&gt;       &lt;dump&gt;  &lt;pass&gt;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;"># / was on /dev/sda2 during installation</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">UUID</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">c10110c9-c86b-4020-ad6c-78e46ec3e642 /               ext4    errors=remount-ro </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">       1</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;"># /boot/efi was on /dev/sda1 during installation</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">UUID</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">325</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">D-4C1F  /boot/efi       vfat    umask=</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0077</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">      0</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">       1</span></span>
<span class="line highlighted"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;"># swap was on /dev/sda3 during installation</span></span>
<span class="line diff remove"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">UUID</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">ec583562-8777-45cb-9512-e19b7ae96ee3 none            swap    sw              </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">       0</span></span>
<span class="line diff add"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;"># UUID=ec583562-8777-45cb-9512-e19b7ae96ee3 none            swap    sw              0       0</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">/dev/sr0</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">        /media/cdrom0   udf,iso9660 user,noauto     </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">       0</span></span></code></pre></div><p>编辑结束后我们还需要编辑 <code>initramfs</code> 配置文件中的 <code>resume</code> 配置来进一步关闭 swap</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> vim /etc/initramfs-tools/conf.d/resume</span></span></code></pre></div><p>在文件中找到和之前注释掉的 <code>/etc/fstab</code> 中 swap 分区相同的设备 UUID 的 <code>RESUME</code> 行：</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light one-dark-pro has-diff vp-code"><code><span class="line diff remove"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">RESUME</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">UUID=ec583562-8777-45cb-9512-e19b7ae96ee3</span></span>
<span class="line diff add"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;"># RESUME=UUID=ec583562-8777-45cb-9512-e19b7ae96ee3</span></span></code></pre></div><p>然后<strong>按顺序执行</strong>下面的两个命令分别更新 <code>grub</code> 和 <code>initramfs</code></p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> update-grub</span></span></code></pre></div><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> update-initramfs -u</span></span></code></pre></div></div><h2 id="先决条件" tabindex="-1">先决条件 <a class="header-anchor" href="#先决条件" aria-label="Permalink to &quot;先决条件&quot;">​</a></h2>`,2),C=t('<h2 id="调整分区" tabindex="-1">调整分区 <a class="header-anchor" href="#调整分区" aria-label="Permalink to &quot;调整分区&quot;">​</a></h2><p>进入 LiveCD 中提供的环境之后我们就可以进行后续的操作了！</p><p>对于 Debian 12 的 LiveCD 而言，它会提供 BusyBox（一个非常轻量和好用的发行版）给我们使用：</p><p><img src="'+c+`" alt=""></p><p>接下来我们在这个命令窗口中输入和使用 <code>parted</code> 命令就可以修改分区了：</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">parted</span></span></code></pre></div><p>进入 <code>parted</code> 之后会是这样的输出：</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> parted</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">GNU</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> Parted </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">3.5</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">Using</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> /dev/sda</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">Welcome</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> to GNU Parted! Type &#39;help&#39;</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> to view a list of commands.</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">parted</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)</span></span></code></pre></div><ul><li>可以通过 <code>help</code> 命令要求 <code>parted</code> 输出可以使用的操作命令</li><li>可以通过 <code>print</code> 打印现在的分区表</li></ul><p>接下来，我们要通过 <code>print</code> 命令查看可以修改的分区：</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;">print</span></span></code></pre></div><div class="info custom-block"><p class="custom-block-title">INFO</p><blockquote><p>Warning: Not all the space available to /dev/sda appears to be used, you can fix the GPT to use all of the space (an extra 545259520 blocks) or continue with the current setting? 警告：<code>/dev/sda</code> 的可用空间似乎未全部使用，您可以修复 GPT 以使用全部空间（额外的 <code>545259520</code> 块），或者继续使用当前设置？</p></blockquote><p>如果出现了这样的提示，不要惊慌，是正常的行为，这意味着我们修改过的 Hyper-V 和其他 VM 控制器提供的虚拟硬盘的数据能被 <code>parted</code> 检测到了。</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">parted</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) print</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;">print</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">Warning:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> Not all the space available to /dev/sda appears to be used, you can fix the GPT to use all of the space </span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">an</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> extra </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">545259520</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> blocks</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">or continue with the current setting?</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">Fix/Ignore?</span></span></code></pre></div><p>这个时候我们根据 <code>parted</code> 的提示，输入 <code>Fix</code> 就可以进行修复和更新以使用全部硬盘空间。</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>Fix</span></span></code></pre></div></div><p>输出应该是这样的结果：</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">parted</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) print</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;">print</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">Model:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> Msft Virtual Disk </span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">scsi</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">Disk:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> /dev/sda </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">42.9</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">GB</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">Sector</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> Size </span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">logical/physical</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">512</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">B/4096B</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">Partition</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> Table: GPT</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">Disk</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> Flags:</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">Number</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  Start   End     Size    File system     Name  Flags</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> 1</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">      1049</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">kB  </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">538</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">MB   </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">537</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">MB   fat32                 boot, esp</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> 2</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">      538</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">MB   </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">41.9</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">GB  </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">41.4</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">GB  ext4</span></span></code></pre></div><div class="tip custom-block"><p class="custom-block-title">TIP</p><p>如果要删除不要的 swap 分区</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">parted</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) print</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;">print</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">Model:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> Msft Virtual Disk </span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">scsi</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">Disk:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> /dev/sda </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">42.9</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">GB</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">Sector</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> Size </span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">logical/physical</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">512</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">B/4096B</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">Partition</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> Table: GPT</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">Disk</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> Flags:</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">Number</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  Start   End     Size    File system     Name  Flags</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> 1</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">      1049</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">kB  </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">538</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">MB   </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">537</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">MB   fat32                 boot, esp</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> 2</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">      538</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">MB   </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">41.9</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">GB  </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">41.4</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">GB  ext4</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> 3</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">      41.9</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">GB  </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">42.9</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">GB  </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">1023</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">MB  linux-swap</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">v1</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)</span></span></code></pre></div><p>可以通过</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">rm</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;"> &lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">分区编</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">号</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;">&gt;</span></span></code></pre></div><p>的命令进行删除操作。</p></div><p>现在我希望将分区 2 拓展扩容到 300G，只需要执行下面的命令就可以扩容了：</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">resizepart</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 2</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 300</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">G</span></span></code></pre></div><p>完成扩容之后检查是否成功：</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">parted</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) print</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;">print</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">Model:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> Msft Virtual Disk </span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">scsi</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">Disk:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> /dev/sda </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">42.9</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">GB</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">Sector</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> Size </span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">logical/physical</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">512</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">B/4096B</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">Partition</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> Table: GPT</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">Disk</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> Flags:</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">Number</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  Start   End     Size    File system     Name  Flags</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> 1</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">      1049</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">kB  </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">538</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">MB   </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">537</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">MB   fat32                 boot, esp</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> 2</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">      538</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">MB   </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">300</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">GB   </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">299</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">GB   ext4</span></span></code></pre></div><p>确认无误之后就可以通过输入下面的命令保存退出 <code>parted</code> 了：</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">quit</span></span></code></pre></div><h2 id="通过-e2fsck-检查文件系统是否正确配置" tabindex="-1">通过 <code>e2fsck</code> 检查文件系统是否正确配置 <a class="header-anchor" href="#通过-e2fsck-检查文件系统是否正确配置" aria-label="Permalink to &quot;通过 \`e2fsck\` 检查文件系统是否正确配置&quot;">​</a></h2><p>现在我们回到了 BusyBox 的命令界面了，可以通过自带的 <code>e2fsck</code> 在应用扩容之前检查一下 <code>/dev/sda2</code> 目标硬盘下属的文件系统是否正常：</p><ul><li>是否正确配置</li><li>是否有可优化的地方</li><li>是否有错误的异常</li></ul><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> e2fsck -f /dev/sda2</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">e2fsck</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 1.47</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">.0 </span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">5-Feb-2023</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">Pass</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 1</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">: Checking inodes, blocks, and sizes</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">Pass</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 2</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">: Checking directory structure</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">Pass</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 3</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">: Checking directory connectivity</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">Pass</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 4</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">: Checking reference counts</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">Pass</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 5</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">: Checking group summary information</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">/dev/sda2:</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 259337</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">/2526384 files </span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">0.2%</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> non-contiguous</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">4445023</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">/10104320 blocks</span></span></code></pre></div><p>检查无误之后就可以进行其他的操作了！</p><h2 id="通过-resize2fs-应用扩容到文件系统" tabindex="-1">通过 <code>resize2fs</code> 应用扩容到文件系统 <a class="header-anchor" href="#通过-resize2fs-应用扩容到文件系统" aria-label="Permalink to &quot;通过 \`resize2fs\` 应用扩容到文件系统&quot;">​</a></h2><p>现在就是最后一步了，我们通过 <code>resize2fs</code> 命令将 <code>/dev/sda2</code> 目标硬盘的大小更新应用到文件系统和内核中：</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> resize2fs /dev/sda2</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">resize2fs</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 1.47</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">.0 </span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">5-Feb-2023</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">Resizing</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> the filesystem on /dev/sda2 to </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">73110859</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">4k</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">blocks.</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">The</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> filesystem on /dev/sda2 is now </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">73110859</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">4k</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">blocks long.</span></span></code></pre></div><h2 id="参考资料" tabindex="-1">参考资料 <a class="header-anchor" href="#参考资料" aria-label="Permalink to &quot;参考资料&quot;">​</a></h2>`,30),u=s("h2",{id:"贡献者",tabindex:"-1"},[i("贡献者 "),s("a",{class:"header-anchor",href:"#贡献者","aria-label":'Permalink to "贡献者"'},"​")],-1),A=s("h2",{id:"文件历史",tabindex:"-1"},[i("文件历史 "),s("a",{class:"header-anchor",href:"#文件历史","aria-label":'Permalink to "文件历史"'},"​")],-1);function b(B,v,E,f,m,D){const h=n("NolebasePageProperties"),e=n("VPNolebaseInlineLinkPreview"),p=n("NolebaseGitContributors"),k=n("NolebaseGitChangelog");return o(),r("div",null,[y,a(h),F,s("ul",null,[s("li",null,[i("由于涉及到硬盘分区的操作，请参考 "),a(e,{href:"/笔记/🎛️ 操作系统/🍥 Debian/通过 Hyper-V 进入 Debian 12 LiveCD 自带的 Rescue Mode（急救模式）.html"},{default:l(()=>[i("通过 Hyper-V 进入 Debian 12 LiveCD 自带的 Rescue Mode（急救模式）")]),_:1}),i(" 启动单独的 LiveCD 离线环境，并在 LiveCD 中提供的 shell 中执行相关的扩容命令操作。")])]),C,s("ul",null,[s("li",null,[a(e,{href:"https://unix.stackexchange.com/q/224156",target:"_blank",rel:"noreferrer"},{default:l(()=>[i("linux - How to safely turn off swap permanently and reclaim the space? (on Debian Jessie) - Unix & Linux Stack Exchange")]),_:1})]),s("li",null,[a(e,{href:"https://unix.stackexchange.com/questions/225459/is-it-safe-to-delete-all-swap-partitions",target:"_blank",rel:"noreferrer"},{default:l(()=>[i("debian - Is it safe to delete all swap partitions? - Unix & Linux Stack Exchange")]),_:1})])]),u,a(p),A,a(k)])}const x=d(g,[["render",b]]);export{P as __pageData,x as default};
