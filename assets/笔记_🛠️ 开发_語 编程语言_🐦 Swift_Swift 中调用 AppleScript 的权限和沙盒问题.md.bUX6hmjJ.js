import{_ as c,c as h,J as t,m as e,a as s,w as n,V as o,E as p,o as d}from"./chunks/framework.WH0rnJL5.js";const f="/assets/Xcode_image_20211029164201.8as54nCc.png",_="/assets/Xcode_image_20211029164434.5-AFdMKn.png",u="/assets/Xcode_image_20211029164627.MXv8uJrz.png",X=JSON.parse('{"title":"","description":"","frontmatter":{},"headers":[],"relativePath":"笔记/🛠️ 开发/語 编程语言/🐦 Swift/Swift 中调用 AppleScript 的权限和沙盒问题.md","filePath":"笔记/🛠️ 开发/語 编程语言/🐦 Swift/Swift 中调用 AppleScript 的权限和沙盒问题.md"}'),g={name:"笔记/🛠️ 开发/語 编程语言/🐦 Swift/Swift 中调用 AppleScript 的权限和沙盒问题.md"},k=o(`<p>应用程序未在运行 错误：</p><div class="language-txt vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">txt</span><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>{</span></span>
<span class="line"><span>	NSAppleScriptErrorAppName = &quot;Google Chrome&quot;;</span></span>
<span class="line"><span>    NSAppleScriptErrorBriefMessage = &quot;Application isn\\U2019t running.&quot;;</span></span>
<span class="line"><span>    NSAppleScriptErrorMessage = &quot;Google Chrome got an error: Application isn\\U2019t running.&quot;;</span></span>
<span class="line"><span>    NSAppleScriptErrorNumber = &quot;-600&quot;;</span></span>
<span class="line"><span>    NSAppleScriptErrorRange = &quot;NSRange: {40, 3}&quot;;</span></span>
<span class="line"><span>}</span></span></code></pre></div><p>出现这个错误，是由两个系统级限制导致的：</p><ol><li>App 当前运行在沙盒模式下（暂时不清楚具体原理）<sup class="footnote-ref"><a href="#fn1" id="fnref1">[1]</a></sup> <sup class="footnote-ref"><a href="#fn2" id="fnref2">[2]</a></sup></li><li>需要配置和设定 <code>NSAppleEventsUsageDescription</code> <sup class="footnote-ref"><a href="#fn3" id="fnref3">[3]</a></sup></li></ol>`,4),m=e("code",null,"NSAppleEventsUsageDescription",-1),S=o(`<ol><li>可以通过临时添加权限许可来处理<sup class="footnote-ref"><a href="#fn4" id="fnref4">[4]</a></sup>：</li></ol><div class="language-xml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">xml</span><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">key</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">&gt;com.apple.security.temporary-exception.apple-events&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">key</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">array</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">string</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">&gt;com.apple.Mail&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">string</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">array</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">&gt;</span></span></code></pre></div><p>在 <code>&lt;项目名称&gt;.entitlements</code> 文件中添加字段 <code>com.apple.security.temporary-exception.apple-events</code>，Type（类型）设定为 <code>Array</code>（数组）：</p><p><img src="`+f+'" alt="|800"></p><p><img src="'+_+'" alt="|800"></p><p>创建好之后在点一下字段名左手边箭头以展开编辑，然后在每一行的 <code>Value</code>（值）中填写需要获取的 App 权限的 <code>appID</code>（比如 Safari 是 <code>com.apple.Safari</code>）</p><p><img src="'+u+`" alt="|800"></p><p>添加许可以后重新运行，发现新的错误：</p><div class="language-txt vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">txt</span><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>{</span></span>
<span class="line"><span>    NSAppleScriptErrorAppName = &quot;Google Chrome&quot;;</span></span>
<span class="line"><span>    NSAppleScriptErrorBriefMessage = &quot;Not authorized to send Apple events to Google Chrome.&quot;;</span></span>
<span class="line"><span>    NSAppleScriptErrorMessage = &quot;Not authorized to send Apple events to Google Chrome.&quot;;</span></span>
<span class="line"><span>    NSAppleScriptErrorNumber = &quot;-1743&quot;;</span></span>
<span class="line"><span>    NSAppleScriptErrorRange = &quot;NSRange: {43, 3}&quot;;</span></span>
<span class="line"><span>}</span></span></code></pre></div>`,9),A=e("h2",{id:"贡献者",tabindex:"-1"},[s("贡献者 "),e("a",{class:"header-anchor",href:"#贡献者","aria-label":'Permalink to "贡献者"'},"​")],-1),v=e("h2",{id:"文件历史",tabindex:"-1"},[s("文件历史 "),e("a",{class:"header-anchor",href:"#文件历史","aria-label":'Permalink to "文件历史"'},"​")],-1),b=e("hr",{class:"footnotes-sep"},null,-1),w={class:"footnotes"},E={class:"footnotes-list"},y={id:"fn1",class:"footnote-item"},B=e("a",{href:"#fnref1",class:"footnote-backref"},"↩︎",-1),N={id:"fn2",class:"footnote-item"},C=e("a",{href:"#fnref2",class:"footnote-backref"},"↩︎",-1),q={id:"fn3",class:"footnote-item"},x=e("a",{href:"#fnref3",class:"footnote-backref"},"↩︎",-1),P={id:"fn4",class:"footnote-item"},T=e("a",{href:"#fnref4",class:"footnote-backref"},"↩︎",-1);function V(F,O,M,G,R,I){const i=p("NolebasePageProperties"),a=p("VPNolebaseInlineLinkPreview"),r=p("NolebaseGitContributors"),l=p("NolebaseGitChangelog");return d(),h("div",null,[t(i),k,e("p",null,[s("此处相关需要注意的属性和字段是："),m,s(" （"),t(a,{href:"https://developer.apple.com/documentation/bundleresources/information_property_list/nsappleeventsusagedescription",target:"_blank",rel:"noreferrer"},{default:n(()=>[s("Apple 开发者官方文档")]),_:1}),s("）")]),S,e("p",null,[t(a,{href:"https://stackoverflow.com/questions/54349237/scripterror-not-authorized-to-send-apple-events-to-terminal-when-running-code-o",target:"_blank",rel:"noreferrer"},{default:n(()=>[s("c# - ScriptError: Visual Studio 2017 macOS 版本运行代码时提示：发送 Apple Events 到 Terminal 未授权 - Stack Overflow")]),_:1})]),e("p",null,[t(a,{href:"https://stackoverflow.com/questions/62668336/trying-to-integrate-apple-script-in-swift-mac-os-app-to-get-the-gui-elements-of",target:"_blank",rel:"noreferrer"},{default:n(()=>[s("xcode - 尝试在 Swift mac os App 中集成 Apple Script 以获取 macOS 上应用程序的 gui 元素 - Stack Overflow")]),_:1})]),e("p",null,[t(a,{href:"https://developer.apple.com/library/archive/documentation/Miscellaneous/Reference/EntitlementKeyReference/Chapters/EnablingAppSandbox.html#//apple_ref/doc/uid/TP40011195-CH4-SW25",target:"_blank",rel:"noreferrer"},{default:n(()=>[s("激活 App 沙盒")]),_:1})]),e("p",null,[s("具体可以参考一下这篇文章："),t(a,{href:"https://www.jessesquires.com/blog/2018/11/17/executing-applescript-in-mac-app-on-macos-mojave/",target:"_blank",rel:"noreferrer"},{default:n(()=>[s(" Executing AppleScript in a Mac app on macOS Mojave and dealing with AppleEvent sandboxing")]),_:1})]),A,t(r),v,t(l),b,e("section",w,[e("ol",E,[e("li",y,[e("p",null,[t(a,{href:"https://stackoverflow.com/questions/52601414/running-applescript-from-swift-not-working",target:"_blank",rel:"noreferrer"},{default:n(()=>[s("macos - 无法在 Swift 中运行 AppleScript - Stack Overflow")]),_:1}),s(),B])]),e("li",N,[e("p",null,[t(a,{href:"https://developer.apple.com/library/archive/qa/qa1888/_index.html",target:"_blank",rel:"noreferrer"},{default:n(()=>[s("技术性 Q&A QA1888: OS X 的沙盒模式和自动化脚本")]),_:1}),s(),C])]),e("li",q,[e("p",null,[t(a,{href:"https://stackoverflow.com/questions/60449827/got-application-isn-t-running-error-600-when-executing-applescript-in-swif",target:"_blank",rel:"noreferrer"},{default:n(()=>[s('xcode - 在 Swift 中执行 AppleScript 得到 "Application isn’t running. (error -600)（应用程序未在运行）" 错误 - Stack Overflow')]),_:1}),s(),x])]),e("li",P,[e("p",null,[t(a,{href:"https://stackoverflow.com/questions/52432402/apple-script-fails-when-run-from-within-a-macos-swift-based-application",target:"_blank",rel:"noreferrer"},{default:n(()=>[s("applescript - Apple Script 在基于 Swift 的 macOS 应用程序上运行时失败 - Stack Overflow")]),_:1}),s(),T])])])])])}const z=c(g,[["render",V]]);export{X as __pageData,z as default};
